package taxes

import (
	"fmt"
	"slices"
)

func GetEstvIncomeRate(communeID, year int) (*EstvIncomeRate, error) {
	var reference []*EstvIncomeRate
	switch year {
	case 2024:
		reference = EstIncomeRateList24
	case 2025:
		reference = EstIncomeRateList25
	default:
		return nil, fmt.Errorf("invalid year: %d", year)
	}
	if !slices.Contains(CommuneIDList, communeID) {
		return nil, fmt.Errorf("invalid communeID: %d", communeID)
	}
	for i := range reference {
		if reference[i].CommuneID == communeID {
			return reference[i], nil
		}
	}
	return nil, fmt.Errorf("not found for communeID %d and year %d", communeID, year)
}

/*
	Please Canton Zurich, don't change the CommuneIDList next years.
	I don't want to deal with communeID-year compatibility
*/

var CommuneIDList = []int{
	131,
	241,
	1,
	2,
	211,
	291,
	51,
	81,
	52,
	297,
	22,
	23,
	242,
	3,
	82,
	213,
	112,
	24,
	83,
	111,
	53,
	25,
	86,
	243,
	54,
	216,
	26,
	214,
	84,
	85,
	215,
	191,
	113,
	192,
	55,
	294,
	218,
	219,
	56,
	151,
	172,
	27,
	114,
	28,
	29,
	57,
	193,
	244,
	58,
	115,
	194,
	116,
	220,
	4,
	5,
	31,
	152,
	221,
	117,
	173,
	59,
	153,
	295,
	60,
	61,
	87,
	296,
	6,
	135,
	33,
	62,
	7,
	154,
	136,
	34,
	176,
	63,
	35,
	8,
	195,
	156,
	9,
	155,
	196,
	88,
	223,
	89,
	90,
	91,
	64,
	65,
	245,
	92,
	137,
	93,
	10,
	157,
	246,
	66,
	37,
	94,
	11,
	224,
	177,
	67,
	95,
	96,
	38,
	138,
	225,
	12,
	68,
	178,
	97,
	139,
	118,
	226,
	98,
	247,
	197,
	99,
	119,
	227,
	100,
	13,
	292,
	101,
	158,
	39,
	141,
	41,
	40,
	228,
	159,
	248,
	249,
	250,
	198,
	43,
	199,
	120,
	69,
	200,
	70,
	102,
	251,
	180,
	14,
	121,
	298,
	71,
	181,
	182,
	72,
	230,
	293,
	231,
	161,
	160,
	261,
}
